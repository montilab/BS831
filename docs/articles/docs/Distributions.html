<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Probability Distributions • BS831</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/simplex/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../../pkgdown.css" rel="stylesheet">
<script src="../../pkgdown.js"></script><meta property="og:title" content="Probability Distributions">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../../index.html">BS831</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.20.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../../index.html">Home</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Markdowns
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li class="dropdown-header">Introduction to Genomics Analysis</li>
    <li>
      <a href="../../articles/docs/matrixOp.html">Efficient Computation in R</a>
    </li>
    <li>
      <a href="../../articles/docs/ExpressionSet.html">The ExpressionSet Data Object</a>
    </li>
    <li>
      <a href="../../articles/docs/Distributions.html">Probability Distributions</a>
    </li>
    <li>
      <a href="../../articles/docs/Mix_Normals.html">Mixture of Normals</a>
    </li>
    <li class="divider">
    <li class="dropdown-header">Preprocessing and Quality Control</li>
    <li>
      <a href="../../articles/docs/Microarray_Processing.html">Data Acquisition and ExpressionSet Basics</a>
    </li>
    <li>
      <a href="../../articles/docs/microarrayQC.html">Quality Control</a>
    </li>
    <li>
      <a href="../../articles/docs/Dimensionality_Reduction.html">Dimensionality Reduction</a>
    </li>
    <li>
      <a href="../../articles/docs/Heatmaps.html">Heatmaps</a>
    </li>
    <li>
      <a href="../../articles/docs/hclust.html">Hierarchical Clustering</a>
    </li>
    <li>
      <a href="../../articles/docs/quantileNormalization.html">Quantile Normalization</a>
    </li>
    <li class="divider">
    <li class="dropdown-header">Comparative Experiments I: Microarrays and Linear Models</li>
    <li>
      <a href="../../articles/docs/SampleSize.html">Sample Size and Statistical Significance</a>
    </li>
    <li>
      <a href="../../articles/docs/MHTcorrection.html">Multiple-Hypothesis Correction</a>
    </li>
    <li>
      <a href="../../articles/docs/Linear_Regression.html">Linear Regression</a>
    </li>
    <li>
      <a href="../../articles/docs/diffanalLM.html">Differential Analysis as Linear Regression</a>
    </li>
    <li>
      <a href="../../articles/docs/Diffanalysis.html">Gene Expression Differential Analysis with Microarrays</a>
    </li>
    <li>
      <a href="../../articles/docs/Diffanal_LimmaBC.html">Gene Expression Differential Analysis based on Limma</a>
    </li>
    <li class="divider">
    <li class="dropdown-header">Comparative Experiments II: RNA-seq and Generalized Lineary Models</li>
    <li>
      <a href="../../articles/docs/RNAseq_ScalNorm.html">RNA-Seq Data Scaling and Normalization</a>
    </li>
    <li>
      <a href="../../articles/docs/DiffanalysisRNAseqComparison.html">RNA-seq Differential Expression Analysis with DEseq2, edgeR and limma</a>
    </li>
    <li class="divider">
    <li class="dropdown-header">Comparative Experiments III: Differential Enrichment Analysis</li>
    <li>
      <a href="../../articles/docs/HyperEnrichment.html">HyperGeometric Enrichment</a>
    </li>
    <li>
      <a href="../../articles/docs/KS_Enrichment.html">KS-based Enrichment</a>
    </li>
    <li>
      <a href="../../articles/docs/GeneSetProjectionGSVA.html">Gene Set Projection based on KS</a>
    </li>
    <li>
      <a href="../../articles/docs/GeneSetProjectionASSIGN.html">Geneset projection based on ASSIGN</a>
    </li>
    <li class="divider">
    <li class="dropdown-header">Classification</li>
    <li>
      <a href="../../articles/docs/featureRedundancy.html">Feature Redundancy: the Good and the Bad</a>
    </li>
    <li>
      <a href="../../articles/docs/Classification_Caret.html">Classification Using Caret</a>
    </li>
    <li class="divider">
    <li class="dropdown-header">Clustering</li>
    <li>
      <a href="../../articles/docs/GenesetMapping4KS.html">Mapping genesets for KS testing</a>
    </li>
    <li>
      <a href="../../articles/docs/Clustering.html">Clustering and Heatmap Visualization</a>
    </li>
  </ul>
</li>
<li>
  <a href="../../reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/montilab/BS831">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Probability Distributions</h1>
                        <h4 class="author">Stefano Monti</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/montilab/BS831/blob/master/vignettes/docs/Distributions.Rmd"><code>vignettes/docs/Distributions.Rmd</code></a></small>
      <div class="hidden name"><code>Distributions.Rmd</code></div>

    </div>

    
    
<p>Let us generate data and plot from few examples of probability distributions. In general, any given distribution <code>dist</code> in R is defined by four functions <code>rdist</code>, <code>pdist</code>, <code>ddist</code>, and <code>qdist</code>, which correspond to the sampling, the CDF, the density (or mass) and the quantile functions, respectively. For example, the Normal distribution is defined by the four functions <code>rnorm</code>, <code>pnorm</code>, <code>dnorm</code>, and <code>qnorm</code>.</p>
<p>Let us generate a sample (X) of 100 points from a standard normal (mean 0 and stdev 1); visualize it as a boxplot; generate a second sample (Y) of points that are linearly related to the first sample.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a>N &lt;-<span class="st"> </span><span class="dv">100</span> </span>
<span id="cb1-2"><a href="#cb1-2"></a>X &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span>(N,<span class="dt">mean=</span><span class="dv">0</span>,<span class="dt">sd=</span><span class="dv">1</span>)</span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="kw"><a href="https://rdrr.io/r/graphics/boxplot.html">boxplot</a></span>(X)</span></code></pre></div>
<p><img src="Distributions_files/figure-html/norm0-1.png" width="700"></p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a>Y &lt;-<span class="st"> </span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span>X <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span>(N)</span>
<span id="cb2-2"><a href="#cb2-2"></a><span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(X,Y,<span class="dt">pch=</span><span class="dv">20</span>)</span>
<span id="cb2-3"><a href="#cb2-3"></a><span class="kw"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span>(<span class="dv">2</span>,<span class="dv">1</span>,<span class="dt">col=</span><span class="st">"red"</span>) <span class="co"># plot a line with intercept 2 and slope 1</span></span>
<span id="cb2-4"><a href="#cb2-4"></a><span class="kw"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span>(<span class="dt">h=</span><span class="dv">0</span>,<span class="dt">lty=</span><span class="dv">3</span>) <span class="co"># show the origin</span></span>
<span id="cb2-5"><a href="#cb2-5"></a><span class="kw"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span>(<span class="dt">v=</span><span class="dv">0</span>,<span class="dt">lty=</span><span class="dv">3</span>) <span class="co"># ..</span></span></code></pre></div>
<p><img src="Distributions_files/figure-html/norm0-2.png" width="700"></p>
<p>Let us now plot the well-known bell-shaped curve and the corresponding CDF.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a>X &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="op">-</span><span class="dv">4</span>,<span class="dv">4</span>,.<span class="dv">1</span>)</span>
<span id="cb3-2"><a href="#cb3-2"></a><span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(X,<span class="kw"><a href="https://rdrr.io/r/stats/Normal.html">dnorm</a></span>(X),<span class="dt">pch=</span><span class="dv">20</span>)</span></code></pre></div>
<p><img src="Distributions_files/figure-html/plot1-1.png" width="700"></p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a><span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(X,<span class="kw"><a href="https://rdrr.io/r/stats/Normal.html">pnorm</a></span>(X),<span class="dt">pch=</span><span class="dv">20</span>)</span></code></pre></div>
<p><img src="Distributions_files/figure-html/plot1-2.png" width="700"></p>
<div id="a-simple-distribution-plot-function" class="section level3">
<h3 class="hasAnchor">
<a href="#a-simple-distribution-plot-function" class="anchor"></a>A simple distribution plot function</h3>
<p>Notice that in the above code, the points plotted are evenly spaced, which is not optimal, since we would like to have higher resolution where most of the density lies. Furthermore, I needed to know where most of a distribution mass lies. Otherwise, I might end up with a truncated plot.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a>X &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="op">-</span><span class="dv">4</span>,<span class="dv">4</span>,.<span class="dv">1</span>)</span>
<span id="cb5-2"><a href="#cb5-2"></a><span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(X,<span class="kw"><a href="https://rdrr.io/r/stats/Normal.html">dnorm</a></span>(X,<span class="dt">mean=</span><span class="dv">0</span>,<span class="dt">sd=</span><span class="dv">3</span>),<span class="dt">pch=</span><span class="dv">20</span>)</span></code></pre></div>
<p><img src="Distributions_files/figure-html/plot2-1.png" width="700"></p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a><span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(X,<span class="kw"><a href="https://rdrr.io/r/stats/Normal.html">dnorm</a></span>(X,<span class="dt">mean=</span><span class="dv">3</span>,<span class="dt">sd=</span><span class="dv">1</span>),<span class="dt">pch=</span><span class="dv">20</span>)</span></code></pre></div>
<p><img src="Distributions_files/figure-html/plot2-2.png" width="700"></p>
<p>To take care of this, we can define a slightly more sophisticated distribution plotting function, using information about a distribution’s quantiles.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a>plot.distn &lt;-<span class="st"> </span><span class="cf">function</span>(qfun, dfun, n, <span class="dt">type=</span><span class="st">"l"</span>, <span class="dt">lty=</span><span class="dv">1</span>, <span class="dt">add=</span><span class="ot">FALSE</span>, <span class="dt">xlab=</span><span class="ot">NULL</span>, <span class="dt">ylab=</span><span class="ot">NULL</span>, <span class="dt">main=</span><span class="ot">NULL</span>, <span class="dt">col=</span><span class="st">"black"</span>, <span class="dt">silent=</span><span class="ot">TRUE</span>, ...)</span>
<span id="cb7-2"><a href="#cb7-2"></a>{</span>
<span id="cb7-3"><a href="#cb7-3"></a>  p &lt;-<span class="st"> </span>(<span class="dv">1</span><span class="op">:</span>(n<span class="dv">-1</span>))<span class="op">/</span>n</span>
<span id="cb7-4"><a href="#cb7-4"></a>  q &lt;-<span class="st"> </span><span class="kw">qfun</span>(p,...)</span>
<span id="cb7-5"><a href="#cb7-5"></a>  </span>
<span id="cb7-6"><a href="#cb7-6"></a>  <span class="cf">if</span> ( add )</span>
<span id="cb7-7"><a href="#cb7-7"></a>    <span class="kw"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span>( q, <span class="kw">dfun</span>(q,...), <span class="dt">lty=</span>lty, <span class="dt">col=</span>col )</span>
<span id="cb7-8"><a href="#cb7-8"></a>  <span class="cf">else</span></span>
<span id="cb7-9"><a href="#cb7-9"></a>    <span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>( q, <span class="kw">dfun</span>(q,...), <span class="dt">type=</span>type, <span class="dt">lty=</span>lty, <span class="dt">col=</span>col, <span class="dt">xlab=</span>xlab,<span class="dt">ylab=</span>ylab,<span class="dt">main=</span>main )</span>
<span id="cb7-10"><a href="#cb7-10"></a></span>
<span id="cb7-11"><a href="#cb7-11"></a>  <span class="co">## this is useful to determine plot boundaries</span></span>
<span id="cb7-12"><a href="#cb7-12"></a>  <span class="cf">if</span> (<span class="op">!</span>silent) <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span> ( <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">0</span>,<span class="kw"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span>(<span class="kw">dfun</span>(q,...))) )</span>
<span id="cb7-13"><a href="#cb7-13"></a>}</span></code></pre></div>
</div>
<div id="normal-or-gaussian-distribution" class="section level3">
<h3 class="hasAnchor">
<a href="#normal-or-gaussian-distribution" class="anchor"></a>Normal (or Gaussian) distribution</h3>
<p>Now we can plot a histogram of 1000 data points drawn from a standard (i.e., mean=0, stdev=1) Normal (or Gaussian) distribution.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a>X1 &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span>(<span class="dv">1000</span>,<span class="dt">mean=</span><span class="dv">0</span>,<span class="dt">sd=</span><span class="dv">1</span>) </span>
<span id="cb8-2"><a href="#cb8-2"></a><span class="kw"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span>(X1)</span></code></pre></div>
<p><img src="Distributions_files/figure-html/norm1-1.png" width="700"></p>
<p>If we want the histogram to show frequencies (i.e., numbers in the 0-1 range), rather than counts, so that we can superimpose the density contour (using the function <code>plot.distn</code>), we can use the argument <code>probability=TRUE</code></p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a><span class="kw"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span>(X1,<span class="dt">probability=</span><span class="ot">TRUE</span>)</span>
<span id="cb9-2"><a href="#cb9-2"></a><span class="kw">plot.distn</span>(qnorm,dnorm,<span class="dt">n=</span><span class="dv">1000</span>,<span class="dt">add=</span><span class="ot">TRUE</span>)</span></code></pre></div>
<p><img src="Distributions_files/figure-html/norm2-1.png" width="700"></p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a><span class="co"># let's increase sample size to increase histogram resolution</span></span>
<span id="cb10-2"><a href="#cb10-2"></a>X1 &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span>(<span class="dv">1000000</span>,<span class="dt">mean=</span><span class="dv">0</span>,<span class="dt">sd=</span><span class="dv">1</span>) </span>
<span id="cb10-3"><a href="#cb10-3"></a><span class="kw"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span>(X1,<span class="dt">probability=</span><span class="ot">TRUE</span>)</span>
<span id="cb10-4"><a href="#cb10-4"></a><span class="kw">plot.distn</span>(qnorm,dnorm,<span class="dt">n=</span><span class="dv">1000</span>,<span class="dt">add=</span><span class="ot">TRUE</span>)</span></code></pre></div>
<p><img src="Distributions_files/figure-html/norm2-2.png" width="700"></p>
</div>
<div id="log-normal-distribution" class="section level3">
<h3 class="hasAnchor">
<a href="#log-normal-distribution" class="anchor"></a>Log-Normal distribution</h3>
<p>Let’s plot from a log-normal distribution.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a>N &lt;-<span class="st"> </span><span class="dv">1000</span> <span class="co"># number of datapoints</span></span>
<span id="cb11-2"><a href="#cb11-2"></a>X2 &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/stats/Lognormal.html">rlnorm</a></span>(N,<span class="dt">meanlog=</span><span class="dv">0</span>,<span class="dt">sdlog=</span><span class="dv">1</span>)</span>
<span id="cb11-3"><a href="#cb11-3"></a><span class="kw"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span>(X2,<span class="dt">probability=</span><span class="ot">TRUE</span>)</span>
<span id="cb11-4"><a href="#cb11-4"></a><span class="kw">plot.distn</span>(qlnorm,dlnorm,<span class="dt">n=</span>N,<span class="dt">add=</span><span class="ot">TRUE</span>,<span class="dt">meanlog=</span><span class="dv">0</span>,<span class="dt">sdlog=</span><span class="dv">1</span>)</span></code></pre></div>
<p><img src="Distributions_files/figure-html/lnorm1-1.png" width="700"></p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a><span class="co"># the plot is truncated. Here's a fix (won't always work)</span></span>
<span id="cb12-2"><a href="#cb12-2"></a><span class="kw">plot.distn</span>(qlnorm,dlnorm,<span class="dt">n=</span>N,<span class="dt">meanlog=</span><span class="dv">0</span>,<span class="dt">sdlog=</span><span class="dv">1</span>)</span>
<span id="cb12-3"><a href="#cb12-3"></a><span class="kw"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span>(X2,<span class="dt">probability=</span><span class="ot">TRUE</span>,<span class="dt">add=</span><span class="ot">TRUE</span>)</span></code></pre></div>
<p><img src="Distributions_files/figure-html/lnorm1-2.png" width="700"></p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a><span class="co"># a log-normal distribution yields data whose logarithm is normally distributed</span></span>
<span id="cb13-2"><a href="#cb13-2"></a>X1 &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span>(N,<span class="dt">mean=</span><span class="dv">0</span>,<span class="dt">sd=</span><span class="dv">1</span>)       <span class="co"># remember X1 ~ N(0,1)</span></span>
<span id="cb13-3"><a href="#cb13-3"></a><span class="kw"><a href="https://rdrr.io/r/stats/qqnorm.html">qqplot</a></span>(X1,<span class="kw"><a href="https://rdrr.io/r/base/Log.html">log</a></span>(X2),<span class="dt">main=</span><span class="st">'qqplot'</span>) <span class="co"># plot it against X2 ~ log-N(0,1)</span></span>
<span id="cb13-4"><a href="#cb13-4"></a><span class="kw"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dt">col=</span><span class="st">"red"</span>)</span></code></pre></div>
<p><img src="Distributions_files/figure-html/lnorm1-3.png" width="700"></p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a><span class="co">## qqplot is equivalent to ..</span></span>
<span id="cb14-2"><a href="#cb14-2"></a><span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/sort.html">sort</a></span>(X1),<span class="kw"><a href="https://rdrr.io/r/base/sort.html">sort</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/Log.html">log</a></span>(X2)))</span></code></pre></div>
<p><img src="Distributions_files/figure-html/lnorm1-4.png" width="700"></p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a><span class="co">## let's see how different means and standard deviations look like ...</span></span>
<span id="cb15-2"><a href="#cb15-2"></a>X2 &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/stats/Lognormal.html">rlnorm</a></span>(N,<span class="dt">meanlog=</span><span class="dv">0</span>,<span class="dt">sdlog=</span><span class="fl">0.5</span>)</span>
<span id="cb15-3"><a href="#cb15-3"></a><span class="kw">plot.distn</span>(qlnorm,dlnorm,<span class="dt">n=</span><span class="dv">10</span><span class="op">*</span>N,<span class="dt">meanlog=</span><span class="dv">0</span>,<span class="dt">sdlog=</span><span class="fl">0.5</span>,<span class="dt">ylab=</span><span class="st">"dlnorm(q,...)"</span>)</span>
<span id="cb15-4"><a href="#cb15-4"></a><span class="kw"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span>(X2,<span class="dt">probability=</span><span class="ot">TRUE</span>,<span class="dt">add=</span><span class="ot">TRUE</span>)</span></code></pre></div>
<p><img src="Distributions_files/figure-html/lnorm1-5.png" width="700"></p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1"></a><span class="kw">plot.distn</span>(qlnorm,dlnorm,<span class="dt">n=</span><span class="dv">10</span><span class="op">*</span>N,<span class="dt">meanlog=</span><span class="dv">0</span>,<span class="dt">sdlog=</span><span class="fl">0.5</span>,<span class="dt">ylab=</span><span class="st">"dlnorm(q,...)"</span>)</span>
<span id="cb16-2"><a href="#cb16-2"></a><span class="kw">plot.distn</span>(qlnorm,dlnorm,<span class="dt">n=</span><span class="dv">10</span><span class="op">*</span>N,<span class="dt">meanlog=</span><span class="dv">0</span>,<span class="dt">sdlog=</span><span class="fl">1.0</span>,<span class="dt">ylab=</span><span class="st">"dlnorm(q,...)"</span>,<span class="dt">add=</span><span class="ot">TRUE</span>, <span class="dt">col=</span><span class="st">'red'</span>,<span class="dt">lty=</span><span class="dv">2</span>)</span>
<span id="cb16-3"><a href="#cb16-3"></a><span class="kw">plot.distn</span>(qlnorm,dlnorm,<span class="dt">n=</span><span class="dv">10</span><span class="op">*</span>N,<span class="dt">meanlog=</span><span class="dv">0</span>,<span class="dt">sdlog=</span><span class="fl">5.0</span>,<span class="dt">ylab=</span><span class="st">"dlnorm(q,...)"</span>,<span class="dt">add=</span><span class="ot">TRUE</span>, <span class="dt">col=</span><span class="st">'blue'</span>,<span class="dt">lty=</span><span class="dv">3</span>)</span>
<span id="cb16-4"><a href="#cb16-4"></a><span class="kw"><a href="https://rdrr.io/r/graphics/legend.html">legend</a></span>(<span class="st">'topright'</span>,<span class="dt">col=</span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">'black'</span>,<span class="st">'red'</span>,<span class="st">'blue'</span>),<span class="dt">lty=</span><span class="dv">1</span><span class="op">:</span><span class="dv">3</span>,<span class="dt">legend=</span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"sdlog=0.5"</span>,<span class="st">"sdlog=1.0"</span>,<span class="st">"sdlog=5.0"</span>))</span></code></pre></div>
<p><img src="Distributions_files/figure-html/lnorm1-6.png" width="700"></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by <a href="https://github.com/tetomonti">Stefano Monti</a>, <a href="https://github.com/lia978">Amy Li</a>, <a href="https://github.com/ericreed">Eric Reed</a>, <a href="https://github.com/anfederico">Anthony Federico</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
