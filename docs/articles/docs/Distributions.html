<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Probability Distributions • BS831</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/simplex/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../../bootstrap-toc.css">
<script src="../../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../../pkgdown.css" rel="stylesheet">
<script src="../../pkgdown.js"></script><link href="../../extra.css" rel="stylesheet">
<script src="../../extra.js"></script><meta property="og:title" content="Probability Distributions">
<meta property="og:description" content="BS831">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../../index.html">BS831</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.20.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../../index.html">Home</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Markdowns
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li class="dropdown-header">Introduction to Genomics Analysis</li>
    <li>
      <a href="../../articles/docs/matrixOp.html">Efficient Computation in R</a>
    </li>
    <li>
      <a href="../../articles/docs/ExpressionSet.html">The ExpressionSet Data Object</a>
    </li>
    <li>
      <a href="../../articles/docs/Distributions.html">Probability Distributions</a>
    </li>
    <li>
      <a href="../../articles/docs/Mix_Normals.html">Mixture of Normals</a>
    </li>
    <li class="divider">
    <li class="dropdown-header">Preprocessing and Quality Control</li>
    <li>
      <a href="../../articles/docs/Microarray_Processing.html">Data Acquisition and ExpressionSet Basics</a>
    </li>
    <li>
      <a href="../../articles/docs/microarrayQC.html">Quality Control</a>
    </li>
    <li>
      <a href="../../articles/docs/Dimensionality_Reduction.html">Dimensionality Reduction</a>
    </li>
    <li>
      <a href="../../articles/docs/Heatmaps.html">Heatmaps</a>
    </li>
    <li>
      <a href="../../articles/docs/hclust.html">Hierarchical Clustering</a>
    </li>
    <li>
      <a href="../../articles/docs/quantileNormalization.html">Quantile Normalization</a>
    </li>
    <li class="divider">
    <li class="dropdown-header">Comparative Experiments I: Microarrays and Linear Models</li>
    <li>
      <a href="../../articles/docs/SampleSize.html">Sample Size and Statistical Significance</a>
    </li>
    <li>
      <a href="../../articles/docs/MHTcorrection.html">Multiple-Hypothesis Correction</a>
    </li>
    <li>
      <a href="../../articles/docs/Linear_Regression.html">Linear Regression</a>
    </li>
    <li>
      <a href="../../articles/docs/diffanalLM.html">Differential Analysis as Linear Regression</a>
    </li>
    <li>
      <a href="../../articles/docs/Diffanalysis.html">Gene Expression Differential Analysis with Microarrays</a>
    </li>
    <li>
      <a href="../../articles/docs/Diffanal_LimmaBC.html">Gene Expression Differential Analysis based on Limma</a>
    </li>
    <li class="divider">
    <li class="dropdown-header">Comparative Experiments II: RNA-seq and Generalized Lineary Models</li>
    <li>
      <a href="../../articles/docs/RNAseq_ScalNorm.html">RNA-Seq Data Scaling and Normalization</a>
    </li>
    <li>
      <a href="../../articles/docs/DiffanalysisRNAseqComparison.html">RNA-seq Differential Expression Analysis with DEseq2, edgeR and limma</a>
    </li>
    <li class="divider">
    <li class="dropdown-header">Comparative Experiments III: Differential Enrichment Analysis</li>
    <li>
      <a href="../../articles/docs/HyperEnrichment.html">HyperGeometric Enrichment</a>
    </li>
    <li>
      <a href="../../articles/docs/KS_Enrichment.html">KS-based Enrichment</a>
    </li>
    <li>
      <a href="../../articles/docs/GenesetMapping4KS.html">Mapping genesets for KS testing</a>
    </li>
    <li>
      <a href="../../articles/docs/GeneSetProjectionGSVA.html">Gene Set Projection based on KS</a>
    </li>
    <li>
      <a href="../../articles/docs/GeneSetProjectionASSIGN.html">Geneset projection based on ASSIGN</a>
    </li>
    <li class="divider">
    <li class="dropdown-header">Classification</li>
    <li>
      <a href="../../articles/docs/featureRedundancy.html">Feature Redundancy: the Good and the Bad</a>
    </li>
    <li>
      <a href="../../articles/docs/Classification_Caret.html">Classification Using Caret</a>
    </li>
    <li class="divider">
    <li class="dropdown-header">Clustering</li>
    <li>
      <a href="../../articles/docs/Clustering.html">Clustering and Heatmap Visualization</a>
    </li>
  </ul>
</li>
<li>
  <a href="../../reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/montilab/BS831">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="Distributions_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Probability Distributions</h1>
                        <h4 class="author">Stefano Monti</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/montilab/BS831/blob/master/vignettes/docs/Distributions.Rmd"><code>vignettes/docs/Distributions.Rmd</code></a></small>
      <div class="hidden name"><code>Distributions.Rmd</code></div>

    </div>

    
    
<p>Let us generate data and plot from few examples of probability distributions. In general, any given distribution <code>dist</code> in R is defined by four functions <code>rdist</code>, <code>pdist</code>, <code>ddist</code>, and <code>qdist</code>, which correspond to the sampling, the CDF, the density (or mass) and the quantile functions, respectively. For example, the Normal distribution is defined by the four functions <code>rnorm</code>, <code>pnorm</code>, <code>dnorm</code>, and <code>qnorm</code>.</p>
<p>Let us generate a sample (X) of 100 points from a standard normal (mean 0 and stdev 1); visualize it as a boxplot and a histogram; generate a second sample (Y) of points that are linearly related to the first sample (based on the linear equation <span class="math inline">\(y = 2x + \epsilon\)</span>, with <span class="math inline">\(\epsilon \sim N(0,1)\)</span>.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">N</span> <span class="op">&lt;-</span> <span class="fl">100</span> 
<span class="va">X</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">N</span>,mean<span class="op">=</span><span class="fl">0</span>,sd<span class="op">=</span><span class="fl">1</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/boxplot.html">boxplot</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span></code></pre></div>
<p><img src="Distributions_files/figure-html/norm0-1.png" width="700"></p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span>

<span class="va">Y</span> <span class="op">&lt;-</span> <span class="fl">2</span> <span class="op">+</span> <span class="va">X</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">N</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/pROC/man/plot.roc.html">plot</a></span><span class="op">(</span><span class="va">X</span>,<span class="va">Y</span>,pch<span class="op">=</span><span class="fl">20</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">1</span>,col<span class="op">=</span><span class="st">"red"</span><span class="op">)</span> <span class="co"># plot a line with intercept 2 and slope 1</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span><span class="op">(</span>h<span class="op">=</span><span class="fl">0</span>,lty<span class="op">=</span><span class="fl">3</span><span class="op">)</span>     <span class="co"># show the origin</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span><span class="op">(</span>v<span class="op">=</span><span class="fl">0</span>,lty<span class="op">=</span><span class="fl">3</span><span class="op">)</span>     <span class="co"># ..</span></code></pre></div>
<p><img src="Distributions_files/figure-html/norm0-2.png" width="700"></p>
<p>Let us now plot the well-known bell-shaped curve and the corresponding CDF.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">X</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">4</span>,<span class="fl">4</span>,<span class="fl">.1</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/pROC/man/plot.roc.html">plot</a></span><span class="op">(</span><span class="va">X</span>,<span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">dnorm</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span>,pch<span class="op">=</span><span class="fl">20</span><span class="op">)</span></code></pre></div>
<p><img src="Distributions_files/figure-html/plot1-1.png" width="700"></p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/pROC/man/plot.roc.html">plot</a></span><span class="op">(</span><span class="va">X</span>,<span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">pnorm</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span>,pch<span class="op">=</span><span class="fl">20</span><span class="op">)</span></code></pre></div>
<p><img src="Distributions_files/figure-html/plot1-2.png" width="700"></p>
<div id="a-simple-distribution-plot-function" class="section level3">
<h3 class="hasAnchor">
<a href="#a-simple-distribution-plot-function" class="anchor"></a>A simple distribution plot function</h3>
<p>Notice that in the above code, the points plotted are evenly spaced, which is not optimal, since we would like to have higher resolution where most of the density lies. Furthermore, we need to a-priori know where most of a distribution mass lies, so as to generate an adequate set of X coordinates. Otherwise, we might end up with a truncated plot, as shown in the examples below.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">X</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">4</span>,<span class="fl">4</span>,<span class="fl">.1</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/pROC/man/plot.roc.html">plot</a></span><span class="op">(</span><span class="va">X</span>,<span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">dnorm</a></span><span class="op">(</span><span class="va">X</span>,mean<span class="op">=</span><span class="fl">0</span>,sd<span class="op">=</span><span class="fl">3</span><span class="op">)</span>,pch<span class="op">=</span><span class="fl">20</span><span class="op">)</span> <span class="co"># too narrow range</span></code></pre></div>
<p><img src="Distributions_files/figure-html/plot2-1.png" width="700"></p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/pROC/man/plot.roc.html">plot</a></span><span class="op">(</span><span class="va">X</span>,<span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">dnorm</a></span><span class="op">(</span><span class="va">X</span>,mean<span class="op">=</span><span class="fl">3</span>,sd<span class="op">=</span><span class="fl">1</span><span class="op">)</span>,pch<span class="op">=</span><span class="fl">20</span><span class="op">)</span> <span class="co"># range skewed to the left</span></code></pre></div>
<p><img src="Distributions_files/figure-html/plot2-2.png" width="700"></p>
<p>To take care of this, we can define a slightly more sophisticated distribution plotting function, using information about a distribution’s quantiles.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">plot.distn</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">qfun</span>, <span class="va">dfun</span>, <span class="va">n</span>, <span class="va">type</span><span class="op">=</span><span class="st">"l"</span>, <span class="va">lty</span><span class="op">=</span><span class="fl">1</span>, <span class="va">add</span><span class="op">=</span><span class="cn">FALSE</span>, <span class="va">xlab</span><span class="op">=</span><span class="cn">NULL</span>, <span class="va">ylab</span><span class="op">=</span><span class="cn">NULL</span>, <span class="va">main</span><span class="op">=</span><span class="cn">NULL</span>, <span class="va">col</span><span class="op">=</span><span class="st">"black"</span>, <span class="va">silent</span><span class="op">=</span><span class="cn">TRUE</span>, <span class="va">...</span><span class="op">)</span>
<span class="op">{</span>
  <span class="va">p</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="va">n</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">/</span><span class="va">n</span>
  <span class="va">q</span> <span class="op">&lt;-</span> <span class="fu">qfun</span><span class="op">(</span><span class="va">p</span>,<span class="va">...</span><span class="op">)</span> <span class="co"># generate the set of X-coordinates based on the distribution quantiles</span>
  
  <span class="kw">if</span> <span class="op">(</span> <span class="va">add</span> <span class="op">)</span>
    <span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span> <span class="va">q</span>, <span class="fu">dfun</span><span class="op">(</span><span class="va">q</span>,<span class="va">...</span><span class="op">)</span>, lty<span class="op">=</span><span class="va">lty</span>, col<span class="op">=</span><span class="va">col</span> <span class="op">)</span>
  <span class="kw">else</span>
    <span class="fu"><a href="https://rdrr.io/pkg/pROC/man/plot.roc.html">plot</a></span><span class="op">(</span> <span class="va">q</span>, <span class="fu">dfun</span><span class="op">(</span><span class="va">q</span>,<span class="va">...</span><span class="op">)</span>, type<span class="op">=</span><span class="va">type</span>, lty<span class="op">=</span><span class="va">lty</span>, col<span class="op">=</span><span class="va">col</span>, xlab<span class="op">=</span><span class="va">xlab</span>,ylab<span class="op">=</span><span class="va">ylab</span>,main<span class="op">=</span><span class="va">main</span> <span class="op">)</span>

  <span class="co">## this is useful to determine plot boundaries</span>
  <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="va">silent</span><span class="op">)</span> <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span> <span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="fu">dfun</span><span class="op">(</span><span class="va">q</span>,<span class="va">...</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">)</span>
<span class="op">}</span></code></pre></div>
</div>
<div id="normal-or-gaussian-distribution" class="section level3">
<h3 class="hasAnchor">
<a href="#normal-or-gaussian-distribution" class="anchor"></a>Normal (or Gaussian) distribution</h3>
<p>Now we can plot a histogram of 1000 data points drawn from a standard (i.e., mean=0, stdev=1) Normal (or Gaussian) distribution.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">X1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">1000</span>,mean<span class="op">=</span><span class="fl">0</span>,sd<span class="op">=</span><span class="fl">1</span><span class="op">)</span> 
<span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">X1</span><span class="op">)</span></code></pre></div>
<p><img src="Distributions_files/figure-html/norm1-1.png" width="700"></p>
<p>If we want the histogram to show frequencies (i.e., numbers in the 0-1 range), rather than counts, so that we can superimpose the density contour (using the function <code>plot.distn</code>), we can use the argument <code>probability=TRUE</code></p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">X1</span>,probability<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>
<span class="fu">plot.distn</span><span class="op">(</span><span class="va">qnorm</span>,<span class="va">dnorm</span>,n<span class="op">=</span><span class="fl">1000</span>,add<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<p><img src="Distributions_files/figure-html/norm2-1.png" width="700"></p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># let's increase sample size to increase histogram resolution</span>
<span class="va">X1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">1000000</span>,mean<span class="op">=</span><span class="fl">0</span>,sd<span class="op">=</span><span class="fl">1</span><span class="op">)</span> 
<span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">X1</span>,probability<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>
<span class="fu">plot.distn</span><span class="op">(</span><span class="va">qnorm</span>,<span class="va">dnorm</span>,n<span class="op">=</span><span class="fl">1000</span>,add<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<p><img src="Distributions_files/figure-html/norm2-2.png" width="700"></p>
</div>
<div id="log-normal-distribution" class="section level3">
<h3 class="hasAnchor">
<a href="#log-normal-distribution" class="anchor"></a>Log-Normal distribution</h3>
<p>Let’s plot from a log-normal distribution.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">N</span> <span class="op">&lt;-</span> <span class="fl">1000</span> <span class="co"># number of datapoints</span>
<span class="va">X2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Lognormal.html">rlnorm</a></span><span class="op">(</span><span class="va">N</span>,meanlog<span class="op">=</span><span class="fl">0</span>,sdlog<span class="op">=</span><span class="fl">1</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">X2</span>,probability<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>
<span class="fu">plot.distn</span><span class="op">(</span><span class="va">qlnorm</span>,<span class="va">dlnorm</span>,n<span class="op">=</span><span class="va">N</span>,add<span class="op">=</span><span class="cn">TRUE</span>,meanlog<span class="op">=</span><span class="fl">0</span>,sdlog<span class="op">=</span><span class="fl">1</span><span class="op">)</span></code></pre></div>
<p><img src="Distributions_files/figure-html/lnorm1-1.png" width="700"></p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># the plot is truncated. Here's a fix (won't always work)</span>
<span class="fu">plot.distn</span><span class="op">(</span><span class="va">qlnorm</span>,<span class="va">dlnorm</span>,n<span class="op">=</span><span class="va">N</span>,meanlog<span class="op">=</span><span class="fl">0</span>,sdlog<span class="op">=</span><span class="fl">1</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">X2</span>,probability<span class="op">=</span><span class="cn">TRUE</span>,add<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<p><img src="Distributions_files/figure-html/lnorm1-2.png" width="700"></p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># a log-normal distribution yields data whose logarithm is normally distributed</span>
<span class="va">X1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">N</span>,mean<span class="op">=</span><span class="fl">0</span>,sd<span class="op">=</span><span class="fl">1</span><span class="op">)</span>       <span class="co"># remember X1 ~ N(0,1)</span>
<span class="fu"><a href="https://rdrr.io/r/stats/qqnorm.html">qqplot</a></span><span class="op">(</span><span class="va">X1</span>,<span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">X2</span><span class="op">)</span>,main<span class="op">=</span><span class="st">'qqplot'</span><span class="op">)</span> <span class="co"># plot it against X2 ~ log-N(0,1)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span>,col<span class="op">=</span><span class="st">"red"</span><span class="op">)</span></code></pre></div>
<p><img src="Distributions_files/figure-html/lnorm1-3.png" width="700"></p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## qqplot is equivalent to ..</span>
<span class="fu"><a href="https://rdrr.io/pkg/pROC/man/plot.roc.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sort.html">sort</a></span><span class="op">(</span><span class="va">X1</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/sort.html">sort</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">X2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="Distributions_files/figure-html/lnorm1-4.png" width="700"></p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## let's see how different means and standard deviations look like ...</span>
<span class="va">X2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Lognormal.html">rlnorm</a></span><span class="op">(</span><span class="va">N</span>,meanlog<span class="op">=</span><span class="fl">0</span>,sdlog<span class="op">=</span><span class="fl">0.5</span><span class="op">)</span>
<span class="fu">plot.distn</span><span class="op">(</span><span class="va">qlnorm</span>,<span class="va">dlnorm</span>,n<span class="op">=</span><span class="fl">10</span><span class="op">*</span><span class="va">N</span>,meanlog<span class="op">=</span><span class="fl">0</span>,sdlog<span class="op">=</span><span class="fl">0.5</span>,ylab<span class="op">=</span><span class="st">"dlnorm(q,...)"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">X2</span>,probability<span class="op">=</span><span class="cn">TRUE</span>,add<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<p><img src="Distributions_files/figure-html/lnorm1-5.png" width="700"></p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">plot.distn</span><span class="op">(</span><span class="va">qlnorm</span>,<span class="va">dlnorm</span>,n<span class="op">=</span><span class="fl">10</span><span class="op">*</span><span class="va">N</span>,meanlog<span class="op">=</span><span class="fl">0</span>,sdlog<span class="op">=</span><span class="fl">0.5</span>,ylab<span class="op">=</span><span class="st">"dlnorm(q,...)"</span><span class="op">)</span>
<span class="fu">plot.distn</span><span class="op">(</span><span class="va">qlnorm</span>,<span class="va">dlnorm</span>,n<span class="op">=</span><span class="fl">10</span><span class="op">*</span><span class="va">N</span>,meanlog<span class="op">=</span><span class="fl">0</span>,sdlog<span class="op">=</span><span class="fl">1.0</span>,ylab<span class="op">=</span><span class="st">"dlnorm(q,...)"</span>,add<span class="op">=</span><span class="cn">TRUE</span>, col<span class="op">=</span><span class="st">'red'</span>,lty<span class="op">=</span><span class="fl">2</span><span class="op">)</span>
<span class="fu">plot.distn</span><span class="op">(</span><span class="va">qlnorm</span>,<span class="va">dlnorm</span>,n<span class="op">=</span><span class="fl">10</span><span class="op">*</span><span class="va">N</span>,meanlog<span class="op">=</span><span class="fl">0</span>,sdlog<span class="op">=</span><span class="fl">5.0</span>,ylab<span class="op">=</span><span class="st">"dlnorm(q,...)"</span>,add<span class="op">=</span><span class="cn">TRUE</span>, col<span class="op">=</span><span class="st">'blue'</span>,lty<span class="op">=</span><span class="fl">3</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/legend.html">legend</a></span><span class="op">(</span><span class="st">'topright'</span>,col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'black'</span>,<span class="st">'red'</span>,<span class="st">'blue'</span><span class="op">)</span>,lty<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>,legend<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"sdlog=0.5"</span>,<span class="st">"sdlog=1.0"</span>,<span class="st">"sdlog=5.0"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="Distributions_files/figure-html/lnorm1-6.png" width="700"></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by <a href="https://github.com/tetomonti">Stefano Monti</a>, <a href="https://github.com/anfederico">Anthony Federico</a>, <a href="https://github.com/ericreed">Eric Reed</a>, <a href="https://github.com/lia978">Amy Li</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
